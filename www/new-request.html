<html>
<head>
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

<!-- Optional theme -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

<!-- Latest compiled and minified JavaScript -->
<script
  src="https://code.jquery.com/jquery-3.1.1.min.js"
  integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
  crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<script type="text/javascript">

var dpw = {
  "_id": "a2ff54d75a9c45bec6119fe38e7ee0ad",
  "_rev": "13-318a812ee4ca15c62376dbdcb3f51355",
  "timestamp": "12-01-2016",
  "requestCategory": {
    "Park Maintenance": [
      "Graffiti",
      "Non-Functioning Water Fountains",
      "Playground Repairs"
    ],
    "Trees": [
      "Dead, Dying, Hazardous Trees",
      "Down Trees Blocking Street/Sidewalk"
    ],
    "Flooding": [
      "Street Flooding",
      "Clogged Basin"
    ],
    "Sewer": [
      "Sink Hole",
      "Sewer Backup",
      "Sewer Spill",
      "Damaged or Missing Manhole Lid",
      "Foul Sewer Odor",
      "Water Leak or Main Break"
    ],
    "Street Light": [
      "Minor Street Light Repair"
    ],
    "Water Services": [
      "Burst Pipe",
      "No Water",
      "Leaking or Damaged Fire Hydrant"
    ],
    "Signs and Signals": [
      "Damaged Traffic Sign",
      "Damaged or Missing Street Name Sign",
      "Street Light is Out",
      "Street Light Pole Down or Damaged"
    ],
    "Streets and Sidewalks": [
      "Potholes",
      "Concrete Repair",
      "Unpaved Road Repair",
      "Bridge Repair"
    ]
  },
  "requestType": {
    "Individual": {
      "ContactFirstName": "Contact First Name",
      "ContactLastName": "Contact Last Name",
      "EmailAddress": "Email Address",
      "Phone": "Phone"
    },
    "Business": {
      "Business Name": "BusinessName",
      "Contact First Name": "Contact First Name",
      "Contact Last Name": "Contact Last Name",
      "Email Address": "Email Address",
      "Phone": "Phone"
    },
    "Anonymous": {
      "Contact First Name": "Anonymous",
      "Contact Last Name": "User",
      "Email Address": "test@test.com",
      "Phone": "Phone"
    }
  },
  "locationType": {
    "Point": {
      "coordinates": [
        -72.26098819699968,
        41.804738030000465
      ],
      "Service City/County": "City/County",
      "Service State": "Service State",
      "Service Postal Code": "Service Postal Code"
    },
    "Address": {
      "Service Street #": "Service Street #",
      "Service Street Prefix": "Service Street Prefix",
      "Service Street Name": "Service Street Name",
      "Service Street Type": "Service Street Type",
      "Service Street Suffix": "Service Street Suffix",
      "Service Unit #": "Service  Unit #",
      "Service City/County": "City/County",
      "Service State": "Service State",
      "Service Postal Code": "Service Postal Code"
    },
    "HighwayExit": {
      "Highway": "Highway",
      "Exit": "Exit",
      "Service City/County": "Service City/Count"
    },
    "Intersection": {
      "Cross Street1 Prefix": "Cross Street1 Prefix",
      "Cross Street1": "Cross Street1",
      "Cross Street1 Name": "Cross Street1 Name",
      "Cross Street1 Type": "Cross Street1 Type",
      "Cross Street1 Suffix": "Cross Street1 Suffix",
      "Cross Street2 Prefix": "Cross Street2 Prefix",
      "Cross Street2": "Cross Street2",
      "Cross Street2 Name": "Cross Street2 Name",
      "Cross Street2 Type": "Cross Street2 Type",
      "Cross Street2 Suffix": "Cross Street2 Suffix",
      "City/County": "City/County"
    }
  },
  "Summary of Request": "Summary of Request",
  "_attachments": {
    "download.jpg": {
      "content_type": "image/jpeg",
      "revpos": 11,
      "digest": "md5-gHF4k0xENdtP+kPS6gPIGg==",
      "length": 5346,
      "stub": true
    }
  }
};

</script>

<script type="text/javascript">

function populatePosition() {
	navigator.geolocation.getCurrentPosition(function(position){
		document.getElementById('lat').value = position.coords.latitude;
		document.getElementById('long').value = position.coords.longitude;
	});
	
}

function populateTypes() {
console.log("loading");
	var finalTypes = [];
	for(var categories in dpw.requestCategory) {
		var catArray = dpw.requestCategory[categories];
		for(var i = 0; i < catArray.length; i++) {
			var thisText = categories+": "+catArray[i];
			var opt = document.createElement("option");
			opt.text = thisText;
			opt.value = thisText;
			document.getElementById("category").add(opt);
			//finalTypes.push(categories+": "+catArray[i]);
			
		}
	}
}

function formIsValid() {
	if(document.getElementById("lat").value == "") {
		var al = document.getElementById("formAlert");
		al.innerText = "Location not available! Please ensure location services are enabled for this page";
		al.style.display = "block"
		return false;
	}
	return true;
}

</script>



</head>

<body>

<div class="page-header">
  <h1>New Service Request</h1>
</div>

<form method="POST" action="add.php">

<label for="fname">First Name</label>
<div class="input-group">
	<input name="fname" type="text" />
</div>

<label for="lname">Last Name</label>
<div class="input-group">
	<input name="lname" type="text" />
</div>


<label for="phone">Phone</label>
<div class="input-group">
	<input name="phone" type="text" />
</div>

<label for="email">E-Mail</label>
<div class="input-group">
	<input name="email" type="text" />
</div>

<label for="category">Category</label>
<div class="input-group">
	<select name="category" id="category"></select>
</div>

<div style="display:none">
<label for="lat">Latitude</label>
<div class="input-group">
	<input name="lat" type="text" id="lat" disabled/>
</div>

<label for="long">Longitude</label>
<div class="input-group">
	<input name="long" type="text" id="long" disabled/>
</div>
</div>
<script type="text/javascript">
populatePosition();
</script>

<label for="picture">Picture Upload</label>
<div class="input-group">
	<input name="picture" type="file" accept="image/*" capture="camera">
</div>

<label for="email">Additional Information</label>
<div class="input-group">
	<input name="description" type="text" size="50"/>
</div>

<input type="button" onclick="javascript:if(formIsValid()) document.forms[0].submit();" value="Submit New Request" />

<div style="display: none" class="alert alert-danger" role="alert" id="formAlert"></div>
</form>

<script type="text/javascript">
populateTypes();
</script>

</body>
</html>
